#!/usr/bin/env bash
set -euo pipefail
echo "[pre-push] Running checks..."

pids=()
bun run lint &
pids+=($!)
bun run tsgo &
pids+=($!)
bun run knip &
pids+=($!)

failed=0
for pid in "${pids[@]}"; do
  if ! wait "$pid"; then failed=1; fi
done

if [ "$failed" -ne 0 ]; then
  echo "[pre-push] Checks failed. Push aborted."
  exit 1
fi
echo "[pre-push] All checks passed."
